var Betty=function(t,e,n){function i(){}function o(t){throw new Error(t)}function r(t){if(!f.virtual)for(var e in f)0===e.indexOf(t)&&f.removeItem(e)}function s(t,n){var r,s,c="script";n=n||i,s=e.createElement(c),r=e.getElementsByTagName(c)[0],s.async=1,s.src=t,s.onload=function(){n()},s.onerror=function(){n(o("failed to load: "+t))},r.parentNode.insertBefore(s,r)}function c(t,e){function n(){return o("failed to load: "+t)}var i=new XMLHttpRequest;i.open("get",t),i.send(),i.addEventListener("error",n),i.addEventListener("load",function(t){var i=t.target;i.status>=400?n(i):e(i.response)})}function a(t,e){new Function("!"+t+"()")(),e&&setTimeout(e,0)}function u(){this.noCache=this.loadRemote=this.stored=this.xDomain=!1,this.uri=this.key="",this.callbacks=[]}var h="BETTY",f=function(){var e=h,n=t.localStorage,o={setItem:i,getItem:i,removeItem:i,virtual:!0};if(!n)return o;try{return n.setItem(e,""),n.removeItem(e),n}catch(r){return o}}();return u.prototype={constructor:u,init:function(t){var e,i,o=this,r=t.config,s=t.callback,c=r.uri,a=r.key,u=r.noCache,d=r.xDomain;return this.uri=c,this.key=a,u!==n&&(this.noCache=u),d!==n&&(this.xDomain=d),e=h+":"+a+":"+c,i=f.getItem(e),this.storeKey=e,u||(this.code=i),i?(this.stored=!0,s&&this.apply(s)):(setTimeout(function(){o.remove(a)},0),s&&this.callbacks.push(s)),this},store:function(t){var e=this.storeKey,n=t.toString();return this.code=n,this.stored=!0,this.noCache||f.setItem(e,n),a(n),this},apply:function(t){function e(){h.forEach(function(t){t()}),l.stored||o("check the padding of "+r)}var n=this,i=this.code,r=this.uri,u=this.noCache,h=this.callbacks,f=this.loadRemote,d=this.xDomain,l=this;return i&&!u?a(i,t):(h.push(t),f||(d?s(r,e):c(r,function(t){n.store("function(){"+t+"}"),e()}),this.loadRemote=!0)),this},remove:function(t){return r(h+":"+t),this}},function(t,e){return(new u).init({config:t,callback:e})}}(window,document);